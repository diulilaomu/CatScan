<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css" />
    <script src="https://unpkg.com/element-plus"></script>
    <script src="/eel.js"></script>
    <style>
        body.dark {
            background-color: #1f1f1f;
            color: #eee;
        }

        body.dark .el-card {
            background-color: #2b2b2b;
            color: #eee;
        }

        body.dark .el-button--success {
            background-color: #3a6f3a;
            color: #fff;
        }

        body.dark .el-button--danger {
            background-color: #a33a3a;
            color: #fff;
        }

        /* 可选：覆盖 Message 弹窗暗色 */
        body.dark .el-message {
            background-color: #2b2b2b;
            color: #eee;
        }
    </style>
</head>



<body class="dark">
    <div id="app">
        <el-card shadow="hover" style="background-color:#2d2d2d; color:#ddd; border: #333;">
            <div style="display:flex; gap:10px; align-items:center;">
                <el-space wrap>
                    <el-button v-for="(item, idx) in addresslist" :key="idx" :type="item.status ? 'success' : 'danger'"
                        plain size="small" @click="copyCommand(item.command)">
                        {{ item.roomName }}
                    </el-button>
                </el-space>
            </div>
        </el-card>
    </div>

    <script>
        const { createApp, ref } = Vue;

        const app = createApp({
            setup() {
                const addresslist = ref([]);

                function showMessage(message, type = 'info') {
                    console.log(message);
                    ElementPlus.ElMessage({
                        showClose: true,
                        message: String(message),
                        type: type,
                    });
                }

                async function copyCommand(command) {
                    try {
                        await navigator.clipboard.writeText(command);
                        showMessage(`已复制 ${command}`, 'success');
                    } catch (err) {
                        showMessage("复制失败：" + err, 'error');
                    }
                }

                // Python 调用此函数
                eel.expose(updateAddressList);
                function updateAddressList(newList) {
                    addresslist.value = newList;
                    // showMessage(`收到新的地址列表，共 ${newList.length} 项`, 'success');
                }

                return {
                    addresslist,
                    copyCommand
                };
            }
        });

        app.use(ElementPlus).mount('#app');
    </script>

</body>

</html>